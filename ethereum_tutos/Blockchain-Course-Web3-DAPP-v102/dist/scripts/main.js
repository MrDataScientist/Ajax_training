"use strict";function startApp(){doFilterStopWatching(),doContractEventWatchStop(),web3&&web3.isConnected()?(setData("connect_status","Connected",!1),setWeb3Version(),autoRetrieveFlag&&doGetAccounts()):setData("connect_status","Not Connected",!0),autoRetrieveFlag&&(doGetNodeStatus(),doGetCompilers())}function doConnect(){var e=document.getElementById("provider_url").value,e=document.getElementById("provider_url").value;window.web3=new Web3(new Web3.providers.HttpProvider(e)),startApp()}function setWeb3Version(){web3.version.getNode(function(e,t){e?setData("version_information",e,!0):(setData("version_information",t,!1),nodeType=t.toLowerCase().includes("metamask")?"metamask":t.toLowerCase().includes("testrpc")?"testrpc":"geth",setUIBasedOnNodeType())})}function doGetNodeStatus(){web3.net.getListening(function(e,t){e?setData("get_peer_count",e,!0):web3.net.getPeerCount(function(e,t){e?setData("get_peer_count",e,!0):setData("get_peer_count","Peer Count: "+t,0==t)})})}function doGetAccounts(){web3.eth.getAccounts(function(e,t){if(e)setData("accounts_count",e,!0);else{if(accounts=t,setData("accounts_count",t.length,!1),0==t.length)return void("metamask"==nodeType&&alert("Unlock MetaMask *and* click 'Get Accounts'"));removeAllChildItems("accounts_list");for(var n=0;n<t.length;n++)addAccountsToList("accounts_list",n,t[n]);var o=web3.eth.coinbase;o&&(o=o.substring(0,25)+"..."),setData("coinbase",o,!1);var a=web3.eth.defaultAccount;a||(web3.eth.defaultAccount=t[0],a="[Undef]"+t[0]),a=a.substring(0,25)+"...",setData("defaultAccount",a,!1)}doGetBalances(accounts),addAccountsToSelects(accounts)})}function doGetBalances(e){removeAllChildItems("account_balances_list");for(var t=0;t<e.length;t++)web3.eth.getBalance(e[t],web3.eth.defaultBlock,function(e,n){var o=web3.fromWei(n,"ether").toFixed(2);addAccountBalancesToList("account_balances_list",t,o)})}function doSendTransaction(){var e=createTransactionObjectJson();web3.eth.sendTransaction(e,function(e,t){if(e)setData("send_transaction_error_or_result",e,!0);else{setData("send_transaction_error_or_result",t,!1);var n=document.getElementById("etherscan_io_tx_link");n.href=createEtherscanIoUrl("tx",t),n.innerHTML="etherscan.io"}})}function doUnlockAccount(){setData("lock_unlock_result","...",!0);var e=document.getElementById("select_to_unlock_account").value,t=document.getElementById("unlock_account_password").value;web3.personal.unlockAccount(e,t,function(t,n){if(t)setData("lock_unlock_result",t,!0);else{var o=e.substring(0,20)+"...Unlocked";n?setData("lock_unlock_result",o,!1):(o="Incorrect Password???",setData("lock_unlock_result",o,!0))}})}function doLockAccount(){setData("lock_unlock_result","...",!0);var e=document.getElementById("select_to_unlock_account").value;web3.personal.lockAccount(e,function(t,n){if(console.log(t,n),t)setData("lock_unlock_result",t,!0);else{setData("lock_unlock_result",e.substring(0,20)+"...Locked",!1)}})}function doGetCompilers(){web3.eth.getCompilers(function(e,t){e?setData("list_of_compilers",e,!0):0==t.length?setData("list_of_compilers","No Compilers!!!",!0):setData("list_of_compilers",t,!1)})}function doCompileSolidityContract(){var e=document.getElementById("sourcecode").value;console.log(flattenSource(e)),web3.eth.compile.solidity(e,function(e,t){if(e)console.log(e),setData("compilation_result",e,!0);else{t=compileResultWindowsHack(t),console.log("Compilation Result=",JSON.stringify(t));var n="",o="",a="";for(var c in t){n=c,o=t[c].code,o||(o=t.code),a=t[c].info?t[c].info.abiDefinition:t.info.abiDefinition;break}setData("compilation_result","Contract#1: "+n,!1),document.getElementById("compiled_bytecode").value=o,document.getElementById("compiled_abidefinition").value=JSON.stringify(a)}})}function doDeployContract(){resetDeploymentResultUI();var e=document.getElementById("compiled_abidefinition").value,t=JSON.parse(e),n=document.getElementById("compiled_bytecode").value,o=web3.eth.contract(t),a=document.getElementById("deployment_estimatedgas").value,c={from:web3.eth.coinbase,data:n,gas:a};o.new(10,c,function(e,t){e?setData("contracttransactionhash","Deployment Failed: "+e,!0):(console.log("RECV:",t),t.address?(document.getElementById("contractaddress").value=t.address,setEtherscanIoLink("contractaddress_link","address",t.address)):(setData("contracttransactionhash",t.transactionHash,!1),setEtherscanIoLink("contracttransactionhash_link","tx",t.transactionHash)))})}function doDeployContractSynchronous(){var e=document.getElementById("compiled_abidefinition").value,t=JSON.parse(e),n=document.getElementById("compiled_bytecode").value,o=web3.eth.contract(t),a=document.getElementById("deployment_estimatedgas").value,c={from:web3.eth.coinbase,data:n,gas:a},l=o.new.getData(10,{data:n});console.log("Contract Data=",l),c.data=l;var r=web3.eth.sendTransaction(c);console.log("TxnHash=",r),web3.eth.getTransactionReceipt(r,function(e,t){e?console.log("SENDTran Error=",e):e&&console.log("SENDTran Hash=",t)})}function createContractInstance(e){var t=document.getElementById("compiled_abidefinition").value,n=JSON.parse(t),o=web3.eth.contract(n),a=e;return a||(a=document.getElementById("contractaddress").value),o.at(a)}function doContractFunctionCall(){var e=createContractInstance(),t=document.getElementById("contract_select_function").value;if("setNum"===t){var n=document.getElementById("setnum_parameter").value,o=e.setNum.call(n);setExecuteResultUI("Call",t,n,o,"",!1)}else e.getNum.call({},web3.eth.defaultBlock,function(e,n){setExecuteResultUI("Call",t,"",n,"",!1)})}function doContractSendCall(){var e=createContractInstance(),t=document.getElementById("contract_execute_estimatedgas").value,n=document.getElementById("setnum_parameter").value,o=document.getElementById("contract_select_function").value,a={from:web3.eth.coinbase,gas:t};"setNum"===o?e.setNum.sendTransaction(n,a,function(e,t){console.log("RECVED>>",e,t),e?setExecuteResultUI("Send Transaction:   ",o,"",e,"",!0):setExecuteResultUI("Send Transaction:   ",o,n,t,t,!1)}):e.getNum.sendTransaction(a,function(e,t){console.log("RECVED>>",e,t),e?setExecuteResultUI("Send Transaction:   ",o,"",e,"",!0):setExecuteResultUI("Send Transaction:   ",o,"",t,t,!1)})}function doFilterWatchStart(){doFilterStopWatching(),setData("watch_event_count","0",!1);var e=generateFilterOptions();console.log("FILTER Watch Options:",JSON.stringify(e)),document.getElementById("applied_watch_filter").value=JSON.stringify(e),filterWatch=web3.eth.filter(e),filterWatch.watch(function(e,t){e?console.error("Filter Watch Error: ",e):(filterEventCounter++,setData("watch_event_count",filterEventCounter,!1),addEventListItem("watch_events_list",t,5))})}function doFilterStopWatching(){filterWatch&&(filterWatch.stopWatching(),filterWatch=void 0),setData("watch_event_count","Not Watching",!0),document.getElementById("applied_watch_filter").value="",clearList("watch_events_list"),filterEventCounter=0}function doFilterGetLogs(){clearList("get_logs_list");var e=generateFilterOptions();console.log("FILTER Get Options:",JSON.stringify(e)),document.getElementById("applied_log_filter").value=JSON.stringify(e),web3.eth.filter(e).get(function(e,t){if(e)console.log("GET Error:",e),setData("get_log_count",e,!0);else{setData("get_log_count",t.length,!1);for(var n=0;n<t.length;n++)addEventListItem("get_logs_list",t[n],50)}})}function doContractEventWatchStart(){contractEvent&&doContractEventWatchStop(),setData("watch_contract_instance_event_count","0",!1),contractEvent=createContractEventInstance(),contractEvent.watch(function(e,t){e?console.error("Contract Event Error"):(contractEventCounter++,setData("watch_contract_instance_event_count",contractEventCounter,!1),addEventListItem("watch_contract_events_list",t,5))})}function doContractEventWatchStop(){contractEvent&&(contractEvent.stopWatching(),contractEvent=void 0),contractEventCounter=0,clearList("watch_contract_events_list"),setData("watch_contract_instance_event_count","---",!0)}function doContractEventGet(){clearList("get_contract_instance_logs_list"),setData("get_contract_instance_log_count","---",!0),createContractEventInstance().get(function(e,t){if(e)setData("get_contract_instance_log_count",e,!0);else{setData("get_contract_instance_log_count",t.length,!1);for(var n=0;n<t.length;n++)addEventListItem("get_contract_instance_logs_list",t[n],50)}})}function createContractEventInstance(){var e=document.getElementById("contract_instance_address").value,t=createContractInstance(e),n=document.getElementById("indexed_event_values").value;n=JSON.parse(n);var o=document.getElementById("additional_filter_event_values").value;return o=JSON.parse(o),t.NumberSetEvent(n,o)}function setUIBasedOnNodeType(){"metamask"===nodeType||"testrpc"==nodeType?setData("lock_unlock_result","Unlock / lock ( ) not supported for "+nodeType,!0):setData("lock_unlock_result","--",!1),"geth"===nodeType||"metamask"===nodeType?(setData("list_of_compilers","getCompilers ( ) & compileSolidity ( ) not supported for "+nodeType,!0),document.getElementById("button_do_compile").disabled=!0,document.getElementById("sourcecode").disabled=!0):(setData("list_of_compilers","--",!1),document.getElementById("button_do_compile").disabled=!1,document.getElementById("sourcecode").disabled=!1),generateTransactionJSON(),copyBytecodeInterfaceToUI()}function updateIFrameContent(e,t){var n=document.getElementById(e);(n.contentDocument||n.contentWindow.document).body.innerHTML=html}function setData(e,t,n){document.getElementById(e).innerHTML=t,document.getElementById(e).classList=n?"notready":"ready"}function arrayToMultilineString(e){for(var t="",n=0;n<e.length;n++)t+=e[n]+"<br>";return t}function addAccountsToList(e,t,n){var o=document.createElement("LI"),a=document.createElement("INPUT");a.value=n,a.id="account"+t,a.disabled=!0,o.appendChild(a),document.getElementById(e).appendChild(o)}function addAccountBalancesToList(e,t,n){var o=document.createElement("LI");o.class="ready";var a=document.createElement("P");a.class="ready",a.innerText=n+" Ether",o.appendChild(a),document.getElementById(e).appendChild(o)}function removeAllChildItems(e){for(var t=document.getElementById(e);t.hasChildNodes();)t.removeChild(t.firstChild)}function addAccountsToSelects(e){removeAllChildItems("send_from_account"),removeAllChildItems("send_to_account"),removeAllChildItems("select_to_unlock_account");for(var t=0;t<e.length;t++)addOptionToSelect("send_from_account",e[t].substring(0,15)+"...",e[t]),addOptionToSelect("send_to_account",e[t].substring(0,15)+"...",e[t]),addOptionToSelect("select_to_unlock_account",e[t].substring(0,15)+"...",e[t])}function addOptionToSelect(e,t,n){var o=document.createElement("OPTION");o.text=t,o.value=n,document.getElementById(e).appendChild(o)}function createTransactionObjectJson(){var e={};e.from=document.getElementById("send_from_account").value,e.to=document.getElementById("send_to_account_value").value;var t=document.getElementById("send_value_in_ether").value,n=web3.toWei(t,"ether");if(e.value=n,"default"!==document.getElementById("send_gas").value&&(e.gas=document.getElementById("send_gas").value),"default"!==document.getElementById("send_gas_price").value&&(e.gasPrice=document.getElementById("send_gas_price").value),"default"!==document.getElementById("send_data").value){var o=document.getElementById("send_data").value;e.data=web3.toHex(o)}return"default"!==document.getElementById("send_nonce").value&&(e.nonce=document.getElementById("send_nonce").value),e}function copyBytecodeInterfaceToUI(){document.getElementById("compiled_bytecode").value=contract_bytecode,document.getElementById("compiled_abidefinition").value=contract_abidefinition}function generateTransactionJSON(){var e=createTransactionObjectJson();setData("send_transaction_object_json",JSON.stringify(e,void 0,2),!1)}function resetTransactionObjectParameters(){document.getElementById("send_gas").value="default",document.getElementById("send_gas_price").value="default",document.getElementById("send_data").value="default",document.getElementById("send_nonce").value="default",document.getElementById("send_value_in_ether").value=0,generateTransactionJSON()}function createEtherscanIoUrl(e,t){var n=etherscanBaseUrl;return"tx"===e?n+="tx/"+t:"block"===e?n+="block/"+t:"address"===e&&(n+="address/"+t),n}function setEtherscanIoLink(e,t,n){var o=document.getElementById(e);o.href=createEtherscanIoUrl(t,n),o.innerHTML=n?"etherscan.io":""}function flattenSource(e){return e.replace(/\n/g," ")}function compileResultWindowsHack(e){var t={};for(var n in e){t[n.replace("<stdin>:","")]=e[n]}return t}function resetDeploymentResultUI(){console.log("utils.resetDeploymentResultUI() TO BE CODED")}function setExecuteResultUI(e,t,n,o,a,c){var l=e+":"+t+"("+n+")";l+=c?" FAILED "+o:"Successful",setData("invoke_details",l,c),setData("invoke_return_value",o,c),console.log("return_value=",o),setData("invoke_contracttransactionhash",a,!1),setEtherscanIoLink("invoke_contracttransactionhash_link","tx",a)}function generateFilterOptions(){var e={},t=document.getElementById("from_block_filter").value;t&&t.trim().length>0&&(e.fromBlock=t),(t=document.getElementById("to_block_filter").value)&&t.trim().length>0&&(e.toBlock=t);var t=document.getElementById("addresses_filter").value;if(t=t.trim(),t.length>0&&(t=t.split("\n"),e.address=t),t=document.getElementById("topics_filter").value,t=t.trim(),console.log("SIG=",getHashEventSignature("NumberSetEvent(address,bytes32,bytes32)")),t.length>0){t=t.split("\n");for(var n=0;n<t.length;n++)t[n]=t[n].trim(),"null"===t[n]&&(t[n]=null);e.topics=t}return setData("options_filter",JSON.stringify(e,void 0,2),!1),e}function addEventListItem(e,t,n){console.log("Event:",t);var o=document.getElementById(e);if(o.childNodes.length>=n){var a=o.childNodes.length-1;o.removeChild(o.childNodes[a])}var c=document.createElement("LI");c.appendChild(createEventListItem(t)),o.insertBefore(c,o.childNodes[0])}function createEventListItem(e){var t=document.createElement("SPAN"),n=document.createElement("A");n.text="Log#"+e.logIndex+", Txn#"+e.transactionIndex,t.appendChild(n);var o=document.createElement("A");return o.text=", Blk#"+e.blockNumber,o.href=createEtherscanIoUrl("block",e.blockNumber),o.target="_blank",t.appendChild(o),e.transactionHash&&(o=document.createElement("A"),o.text=", Txn, ",o.href=createEtherscanIoUrl("tx",e.transactionHash),o.target="_blank",t.appendChild(o)),e.address&&(o=document.createElement("A"),o.text="Addr",o.href=createEtherscanIoUrl("address",e.address),o.target="_blank",t.appendChild(o)),t}function clearList(e){for(var t=document.getElementById(e),n=t.childNodes.length-1;n>=0;n--)t.removeChild(t.childNodes[n])}function addContractEventListItem(e,t,n){console.log(JSON.stringify(t))}function getHashEventSignature(e){return web3.sha3(e)}var contract_abidefinition='[{"constant":false,"inputs":[],"name":"getNum","outputs":[{"name":"n","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"n","type":"uint256"}],"name":"setNum","outputs":[],"payable":false,"type":"function"},{"inputs":[{"name":"x","type":"uint256"}],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"caller","type":"address"},{"indexed":true,"name":"oldNum","type":"bytes32"},{"indexed":true,"name":"newNum","type":"bytes32"}],"name":"NumberSetEvent","type":"event"}]',contract_bytecode="0x6060604052341561000c57fe5b604051602080610168833981016040528080519060200190919050505b806000819055505b505b610126806100426000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806367e0badb146044578063cd16ecbf146067575bfe5b3415604b57fe5b60516084565b6040518082815260200191505060405180910390f35b3415606e57fe5b60826004808035906020019091905050608f565b005b600060005490505b90565b60006000549050816000819055506000546001026000191681600102600019163373ffffffffffffffffffffffffffffffffffffffff167f108fd0bf2253f6baf35f111ba80fb5369c2e004b88e36ac8486fcee0c87e61ce60405180905060405180910390a45b50505600a165627a7a72305820b86215323334042910c2707668d7cc3c3ec760d2f5962724042482293eba5f6b0029",autoRetrieveFlag=!0,accounts,filterWatch,filterEventCounter,contractEvent,contractEventCounter=0,nodeType="geth";window.addEventListener("load",function(){if("undefined"!=typeof web3)window.web3=new Web3(web3.currentProvider);else{console.log("Injected web3 Not Found!!!"),window.web3=new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));var e=document.getElementById("provider_url").value;window.web3=new Web3(new Web3.providers.HttpProvider(e))}startApp()});var etherscanBaseUrl="https://ropsten.etherscan.io/";